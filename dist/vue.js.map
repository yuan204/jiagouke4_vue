{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["\n\nclass Observer{\n    constructor(data){\n        this.walk(data)\n    }\n    walk(data){ // 循环对象 尽量不用for in （会遍历原型链）\n        let keys = Object.keys(data);\n        keys.forEach(key=> {\n            defineReactive(data,key,data[key])\n        })\n    }\n}\n// 性能不好的原因在于 所有的属性都被重新定义了一遍\n// 一上来需要将对象深度代理 性能差\nfunction defineReactive(data,key,value){ //  闭包\n    // 属性会全部被重写增加了get和set\n    observe(value); // 递归代理属性\n    Object.defineProperty(data,key,{\n        get(){ // vm.xxx\n            return value;\n        },\n        set(newValue){ // vm.xxx = {a:1} 赋值一个对象的话 也可以实现响应式数据\n            if(newValue === value) return\n            observe(newValue)\n            value = newValue;\n        }\n    })\n}\nexport function observe(data) {\n    if(typeof data !== 'object' || data == null){\n        return ; // 如果不是对象类型，那么不要做任何处理\n    }\n\n    // 我稍后要区分 如果一个对象已经被观测了，就不要再次被观测了\n    // __ob__ 标识是否有被观测过\n\n    return new Observer(data)\n};","import { observe } from \"./observe/index\";\n\nexport function initState(vm) {\n    const options = vm.$options\n\n    // 后续实现计算属性 、 watcher 、 props 、methods\n    if (options.data) {\n        initData(vm);\n    }\n\n}\n\n\nfunction initData(vm) {\n    let data = vm.$options.data;\n    // 如果是函数就拿到函数的返回值 否则就直接采用data作为数据源\n    data = vm._data =  typeof data === 'function' ? data.call(vm) : data\n\n    // 属性劫持 采用defineProperty将所有的属性进行劫持\n\n    observe(data)\n}","import { initState } from \"./state\";\n\nexport default function initMixin(Vue){\n    Vue.prototype._init = function(options){\n        debugger;\n        const vm = this;\n        vm.$options = options // 所有后续的扩展方法都有一个$options选项可以获取用户的所有选项\n        // 对于实例的数据源 props data methods computed watch\n        // props data\n        initState(vm);\n        // vue中会判断如果是$开头的属性不会被变成响应式数据\n    }   \n\n\n}\n\n","// 整个自己编写的Vue的入口\n\nimport initMixin from \"./init\"\n\n// es6的类 要求所有的扩展都在类的内部来进行扩展\n\nfunction Vue(options){\n    this._init(options)\n}\ninitMixin(Vue);// 后续在扩展都可以采用这种方式\n\n\n\n// 给Vue添加原型方法我们通过文件的方式来添加，防止所有的功能都在一个文件中来处理\nexport default Vue"],"names":["Observer","data","walk","keys","Object","forEach","key","defineReactive","value","observe","defineProperty","get","set","newValue","initState","vm","options","$options","initData","_data","call","initMixin","Vue","prototype","_init"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAEMA;EACF,oBAAYC,IAAZ,EAAiB;EAAA;;EACb,SAAKC,IAAL,CAAUD,IAAV;EACH;;;;aACD,cAAKA,IAAL,EAAU;EAAE;EACR,UAAIE,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYF,IAAZ,CAAX;EACAE,MAAAA,IAAI,CAACE,OAAL,CAAa,UAAAC,GAAG,EAAG;EACfC,QAAAA,cAAc,CAACN,IAAD,EAAMK,GAAN,EAAUL,IAAI,CAACK,GAAD,CAAd,CAAd;EACH,OAFD;EAGH;;;;;EAGL;;;EACA,SAASC,cAAT,CAAwBN,IAAxB,EAA6BK,GAA7B,EAAiCE,KAAjC,EAAuC;EAAE;EACrC;EACAC,EAAAA,OAAO,CAACD,KAAD,CAAP,CAFmC;;EAGnCJ,EAAAA,MAAM,CAACM,cAAP,CAAsBT,IAAtB,EAA2BK,GAA3B,EAA+B;EAC3BK,IAAAA,GAD2B,iBACtB;EAAE;EACH,aAAOH,KAAP;EACH,KAH0B;EAI3BI,IAAAA,GAJ2B,eAIvBC,QAJuB,EAId;EAAE;EACX,UAAGA,QAAQ,KAAKL,KAAhB,EAAuB;EACvBC,MAAAA,OAAO,CAACI,QAAD,CAAP;EACAL,MAAAA,KAAK,GAAGK,QAAR;EACH;EAR0B,GAA/B;EAUH;;EACM,SAASJ,OAAT,CAAiBR,IAAjB,EAAuB;EAC1B,MAAG,QAAOA,IAAP,MAAgB,QAAhB,IAA4BA,IAAI,IAAI,IAAvC,EAA4C;EACxC,WADwC;EAE3C,GAHyB;EAM1B;;;EAEA,SAAO,IAAID,QAAJ,CAAaC,IAAb,CAAP;EACH;;ECpCM,SAASa,SAAT,CAAmBC,EAAnB,EAAuB;EAC1B,MAAMC,OAAO,GAAGD,EAAE,CAACE,QAAnB,CAD0B;;EAI1B,MAAID,OAAO,CAACf,IAAZ,EAAkB;EACdiB,IAAAA,QAAQ,CAACH,EAAD,CAAR;EACH;EAEJ;;EAGD,SAASG,QAAT,CAAkBH,EAAlB,EAAsB;EAClB,MAAId,IAAI,GAAGc,EAAE,CAACE,QAAH,CAAYhB,IAAvB,CADkB;;EAGlBA,EAAAA,IAAI,GAAGc,EAAE,CAACI,KAAH,GAAY,OAAOlB,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,CAACmB,IAAL,CAAUL,EAAV,CAA7B,GAA6Cd,IAAhE,CAHkB;;EAOlBQ,EAAAA,OAAO,CAACR,IAAD,CAAP;EACH;;ECnBc,SAASoB,SAAT,CAAmBC,GAAnB,EAAuB;EAClCA,EAAAA,GAAG,CAACC,SAAJ,CAAcC,KAAd,GAAsB,UAASR,OAAT,EAAiB;EACnC;EACA,QAAMD,EAAE,GAAG,IAAX;EACAA,IAAAA,EAAE,CAACE,QAAH,GAAcD,OAAd,CAHmC;EAInC;EACA;;EACAF,IAAAA,SAAS,CAACC,EAAD,CAAT,CANmC;EAQtC,GARD;EAWH;;ECdD;;EAMA,SAASO,GAAT,CAAaN,OAAb,EAAqB;EACjB,OAAKQ,KAAL,CAAWR,OAAX;EACH;;EACDK,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}